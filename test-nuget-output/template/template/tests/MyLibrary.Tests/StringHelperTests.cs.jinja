using System;
using FluentAssertions;
using {{ namespace_name }}.Utilities;
using Xunit;

namespace {{ namespace_name }}.Tests;

/// <summary>
/// Unit tests for the StringHelper utility class.
/// </summary>
public sealed class StringHelperTests
{
    [Theory]
    [InlineData("hello world", "Hello World")]
    [InlineData("HELLO WORLD", "Hello World")]
    [InlineData("hello", "Hello")]
    public void ToTitleCase_WithValidInput_ReturnsCorrectFormat(string input, string expected)
    {
        // Act
        var result = StringHelper.ToTitleCase(input);

        // Assert
        result.Should().Be(expected);
    }

    [Fact]
    public void ToTitleCase_WithNull_ThrowsArgumentNullException()
    {
        // Act
        Action act = () => StringHelper.ToTitleCase(null!);

        // Assert
        act.Should().Throw<ArgumentNullException>();
    }

    [Theory]
    [InlineData("Hello World", 5, true, "He...")]
    [InlineData("Hello World", 5, false, "Hello")]
    [InlineData("Hello", 10, true, "Hello")]
    [InlineData("Hello World", 11, true, "Hello World")]
    public void Truncate_WithVariousInputs_ReturnsExpectedResult(
        string input,
        int maxLength,
        bool ellipsis,
        string expected)
    {
        // Act
        var result = StringHelper.Truncate(input, maxLength, ellipsis);

        // Assert
        result.Should().Be(expected);
    }

    [Fact]
    public void Truncate_WithNull_ThrowsArgumentNullException()
    {
        // Act
        Action act = () => StringHelper.Truncate(null!, 5);

        // Assert
        act.Should().Throw<ArgumentNullException>();
    }

    [Fact]
    public void Truncate_WithNegativeMaxLength_ThrowsArgumentOutOfRangeException()
    {
        // Act
        Action act = () => StringHelper.Truncate("test", -1);

        // Assert
        act.Should().Throw<ArgumentOutOfRangeException>();
    }

    [Theory]
    [InlineData("HelloWorld", "helloWorld")]
    [InlineData("hello_world", "helloWorld")]
    [InlineData("hello-world", "helloWorld")]
    [InlineData("hello world", "helloWorld")]
    [InlineData("HELLO WORLD", "helloWorld")]
    public void ToCamelCase_WithValidInput_ReturnsCorrectFormat(string input, string expected)
    {
        // Act
        var result = StringHelper.ToCamelCase(input);

        // Assert
        result.Should().Be(expected);
    }

    [Fact]
    public void ToCamelCase_WithNull_ThrowsArgumentNullException()
    {
        // Act
        Action act = () => StringHelper.ToCamelCase(null!);

        // Assert
        act.Should().Throw<ArgumentNullException>();
    }

    [Theory]
    [InlineData("helloWorld", "HelloWorld")]
    [InlineData("hello_world", "HelloWorld")]
    [InlineData("hello-world", "HelloWorld")]
    [InlineData("hello world", "HelloWorld")]
    public void ToPascalCase_WithValidInput_ReturnsCorrectFormat(string input, string expected)
    {
        // Act
        var result = StringHelper.ToPascalCase(input);

        // Assert
        result.Should().Be(expected);
    }

    [Fact]
    public void ToPascalCase_WithNull_ThrowsArgumentNullException()
    {
        // Act
        Action act = () => StringHelper.ToPascalCase(null!);

        // Assert
        act.Should().Throw<ArgumentNullException>();
    }
}
